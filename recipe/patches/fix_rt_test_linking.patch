From ff999768234747d6b50fe7bdcf750ed9bc7214d9 Mon Sep 17 00:00:00 2001
From: yann_dm <yann.montmarin@gmail.com>
Date: Fri, 7 Oct 2022 10:05:54 +0200
Subject: [PATCH 3/3] fix: explicit rt linking

---
 tests/CMakeLists.txt | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

diff --git tests/CMakeLists.txt tests/CMakeLists.txt
index ef02326..2b8881d 100644
--- tests/CMakeLists.txt
+++ tests/CMakeLists.txt
@@ -41,6 +41,9 @@ add_definitions(-DTEST_DIRECTORY="${CMAKE_SOURCE_DIR}/tests/data")
 # This macro will create a binary from `NAME.cc', link it against Boost and add
 # it to the test suite.
 #
+
+find_library(RT_LIB rt)
+
 macro(ADD_TESTCASE NAME GENERATED)
   if(${GENERATED} STREQUAL TRUE)
     add_unit_test(${NAME} ${CMAKE_CURRENT_BINARY_DIR}/${NAME}.cc)
@@ -46,7 +49,11 @@ macro(ADD_TESTCASE NAME GENERATED)
     add_unit_test(${NAME} ${NAME}.cc)
   endif()
   target_include_directories(${NAME} PRIVATE ../src Boost::unit_test_framework)
-  target_link_libraries(${NAME} ${PROJECT_NAME}-gpl)
+  if(RT_LIB)
+    target_link_libraries(${NAME} ${PROJECT_NAME}-gpl ${RT_LIB})
+  else()
+    target_link_libraries(${NAME} ${PROJECT_NAME}-gpl)
+  endif()
 endmacro(ADD_TESTCASE)

 find_package(OpenMP)
-- 
2.25.1
